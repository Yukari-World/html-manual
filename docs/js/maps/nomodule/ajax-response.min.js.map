{"version":3,"sources":["nomodule/ajax-response.js"],"names":["checkStatus","response","status","error","Error","statusText","parseJSON","json","SendAjax","sendURL","form","Promise","resolve","reject","self","fetch","method","body","then","catch","xhr","XMLHttpRequest","open","addEventListener","readyState","timeout","send"],"mappings":"AAgBA,SAASA,YAAYC,GAGpB,GAAIA,EAASC,QAAU,KAAOD,EAASC,OAAS,IAC/C,OAAOD,EACD,CACN,IAAIE,EAAQ,IAAIC,MAAMH,EAASI,YAE/B,MADAF,EAAMF,SAAWA,EACXE,GAYR,SAASG,UAAUL,GAElB,OAAOA,EAASM,OAYjB,SAASC,SAASC,EAASC,GAC1B,OAAO,IAAIC,QAAQ,SAAUC,EAASC,GACrC,GAAIC,KAAKC,MACRA,MAAMN,GACLO,OAAQ,OACRC,KAAMP,IAELQ,KAAKlB,aACLkB,KAAKZ,WACLY,KAAK,SAAUX,GACfK,EAAQL,KAERY,MAAM,SAAUhB,GAChBU,EAAOV,SAEH,CAEN,IAAIiB,EAAM,IAAIC,eACdD,EAAIE,KAAK,OAAQb,GAAS,GAC1BW,EAAIG,iBAAiB,OAAQ,WACL,IAAnBH,EAAII,YAAmC,MAAfJ,EAAIlB,QAC/BU,EAAQQ,EAAInB,YAIdmB,EAAIG,iBAAiB,QAAS,SAAUpB,GACvCU,EAAOV,KAGRiB,EAAIG,iBAAiB,UAAW,WAC/BV,EAAO,wBAGRO,EAAIK,QAAU,IACdL,EAAIM,KAAKhB","file":"nomodule\\ajax-response.min.js","sourcesContent":["/**\n * @fileoverview Ajaxレスポンス取得処理に使用するAjax\n *\n * @module  nomodule/ajax-response\n * @since   1.0.0\n * @version 1.0.0\n */\n\n/**\n * HTTPステータスコードの確認\n *\n * @param   {Response}          response    レスポンスデータ\n * @returns {Response|Error}                HTTPステータスコードが200番台ならレスポンスデータ、そうでなければエラー\n * @since   1.0.0\n * @version 1.0.0\n */\nfunction checkStatus(response) {\n\t// HTTPステータスコードが200番台ではない場合\n\t// 類似方法にresponse.okがあるが大部分のブラウザが非対応なので非推奨\n\tif (response.status >= 200 && response.status < 300) {\n\t\treturn response;\n\t} else {\n\t\tlet error = new Error(response.statusText);\n\t\terror.response = response;\n\t\tthrow error;\n\t}\n}\n\n/**\n * JSONデータの切り出し\n *\n * @param   {Response}  response    レスポンスデータ\n * @returns {JSON}                  レスポンスに格納されているJSONデータ\n * @since   1.0.0\n * @version 1.0.0\n */\nfunction parseJSON(response) {\n\t// console.log(response);\n\treturn response.json();\n}\n\n/**\n * Ajax転送処理\n *\n * @param   {string}                        sendURL 転送先URL\n * @param   {FormData}                      [form]  転送するForm Data(無くても問題ない)\n * @returns {Promise.JSON|Promise.Error}            JSONデータもしくはエラー内容\n * @since   1.0.0\n * @version 1.0.0\n */\nfunction SendAjax(sendURL, form) {\n\treturn new Promise(function (resolve, reject) {\n\t\tif (self.fetch) {\n\t\t\tfetch(sendURL, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: form\n\t\t\t})\n\t\t\t\t.then(checkStatus)\n\t\t\t\t.then(parseJSON)\n\t\t\t\t.then(function (json) {\n\t\t\t\t\tresolve(json);\n\t\t\t\t})\n\t\t\t\t.catch(function (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t} else {\n\t\t\t// Fetch API未対応時の処理\n\t\t\tlet xhr = new XMLHttpRequest();\n\t\t\txhr.open('POST', sendURL, true);\n\t\t\txhr.addEventListener('load', function () {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 200) {\n\t\t\t\t\tresolve(xhr.response);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\txhr.addEventListener('error', function (error) {\n\t\t\t\treject(error);\n\t\t\t});\n\n\t\t\txhr.addEventListener('timeout', function () {\n\t\t\t\treject('connection timeout');\n\t\t\t});\n\n\t\t\txhr.timeout = 30000;\n\t\t\txhr.send(form);\n\t\t}\n\t});\n}\n"]}