import{storageAvailable}from"./common.min.js";import{SendAjax}from"./ajax-response.min.js";const sideList=["Main","CSS","HTML","JavaScript","Language","Node","PHP","SCSS","SQL","Wordpress","Other"],startTime=Date.now();let randomWordList,xorRand,bWordDecide=!1,sideToggle=[];class XorShift{constructor(t=Math.floor(Date.now()/1e3)){let e=new Date;this.x=Math.max(Math.floor(e.getDate()**((e.getMonth()+1)/4+2)),(e.getMonth()+1)*e.getDate()*Math.max(e.getSeconds()**2,31)*Math.max(e.getMinutes()**2,53)),this.y=Math.max(Math.max(e.getSeconds(),5)**Math.floor(Math.max(e.getMinutes(),10)/10)+Math.max(e.getSeconds(),1)*Math.max(e.getMinutes(),1)*Math.floor(e.getFullYear()/10)),this.z=randomWordList.length**4+(randomWordList[2].summary.length+randomWordList[3].summary.length+randomWordList[5].summary.length+randomWordList[7].summary.length)*(randomWordList[11].summary.length+randomWordList[13].summary.length+randomWordList[17].summary.length+randomWordList[19].summary.length)*(randomWordList[23].summary.length+randomWordList[29].summary.length)+(randomWordList[31].summary.length+randomWordList[37].summary.length),this.w=t,console.log("Seed Info:"),console.log("X: "+this.toHex(this.x)+" ("+this.x+")"),console.log("Y: "+this.toHex(this.y)+" ("+this.y+")"),console.log("Z: "+this.toHex(this.z)+" ("+this.z+")"),console.log("W: "+this.toHex(this.w)+" ("+this.w+")")}toHex(t){return"0x"+("00000000"+t.toString(16).toUpperCase()).substr(-8)}randomInt32(){let t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>>19^t^t>>>8,this.w}randomFloat(){let t=this.randomInt32();return t<0&&(t=~t),t/(2**31-1)}}function getRandomWord(){return new Promise(function(t,e){SendAjax("json/randomWord.json",new FormData,"GET").then(function(e){t(e)}).catch(function(t){console.error("request failed",t),e(t)})})}function secondsInterval(t=5){let e=new Date;e.getSeconds()%t==0&&!1===bWordDecide?(bWordDecide=!0,setrandomWord()):e.getSeconds()%t==1&&!0===bWordDecide&&(bWordDecide=!1)}async function randomOutput(t){const e=document.getElementById("randomOutput"),o=document.createElement("dl");let n=0;o.setAttribute("id","RandomList"),e.textContent="",e.appendChild(o);const d=document.getElementById("RandomList");if(window.Worker){const t=new Worker("js/WorkerTask.min.js");t.addEventListener("message",function(t){let e=t.data;switch(e.mode){case"listResult":d.insertAdjacentHTML("beforeend",e.post);break;case"tagList":console.log(e.post);break;default:console.log('Task mode "'+e.mode+'" is not found.')}}),t.addEventListener("messageerror",function(t){console.error("Task failed",t.data)}),t.postMessage({mode:"createRandList"})}else for(let e of t){const t=document.createElement("dt"),o=document.createElement("dd");t.setAttribute("id","wordID"+ ++n),t.insertAdjacentHTML("beforeend","<h3>"+e.title+"</h3><h4>出典: "+e.original+"</h4>"),o.insertAdjacentHTML("beforeend",e.summary),d.appendChild(t),d.appendChild(o)}}function setrandomWord(){let t=Math.floor(xorRand.randomFloat()*randomWordList.length);const e=document.getElementById("randomWord");e.setAttribute("href","scp-randomWord.html#wordID"+(t+1)),e.textContent="",e.insertAdjacentHTML("beforeend",randomWordList[t].title)}document.addEventListener("DOMContentLoaded",async function(){const t=storageAvailable("localStorage");await getRandomWord().then(function(t){randomWordList=t}).catch(function(t){console.error(t)}),xorRand=new XorShift,document.getElementById("expandAll").addEventListener("click",function(){for(let e of sideList){const o=document.getElementById("btn"+e);document.getElementById("link"+e).checked=!0,sideToggle[e]="true",o.textContent="-",t&&localStorage.setItem(e+"Toggle","true")}}),document.getElementById("collapseAll").addEventListener("click",function(){for(let e of sideList){const o=document.getElementById("btn"+e);document.getElementById("link"+e).checked=!1,sideToggle[e]="false",o.textContent="+",t&&localStorage.setItem(e+"Toggle","false")}});for(let e of sideList){const o=document.getElementById("btn"+e),n=document.getElementById("link"+e);sideToggle[e]=t?localStorage.getItem(e+"Toggle"):"false",null===sideToggle[e]||"false"===sideToggle[e]||(o.textContent="-",n.checked=!0),n.addEventListener("change",function(){null===sideToggle[e]||"false"===sideToggle[e]?(sideToggle[e]="true",t&&localStorage.setItem(e+"Toggle","true"),o.textContent="-"):(sideToggle[e]="false",t&&localStorage.setItem(e+"Toggle","false"),o.textContent="+")})}const e=document.getElementById("countRandom");null!==e&&(e.textContent=randomWordList.length),null!==document.getElementById("randomOutput")&&randomOutput(randomWordList),setrandomWord(),setInterval(function(){secondsInterval(10)},50)}),window.addEventListener("load",function(){document.getElementById("LoadTime").textContent=Date.now()-startTime+"ms"});
//# sourceMappingURL=maps/Main.min.js.map